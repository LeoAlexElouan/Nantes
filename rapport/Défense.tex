\documentclass{beamer}
\usepackage{graphicx}


\usecolortheme{rose}
\useoutertheme{infolines}
\useinnertheme{rectangles}
\usecolortheme{whale}

\setbeamertemplate{headline}
{%

\begin{beamercolorbox}[center]{section in head/foot}
\vskip2pt\thesection.~\insertsection\vskip2pt
\end{beamercolorbox}%
%
}

\makeatletter
\def\ps@navigation@titlepage{%
  \setbeamertemplate{headline}{}
  \@nameuse{ps@navigation}}
\addtobeamertemplate{title page}{\thispagestyle{navigation@titlepage}}{}
\makeatother


\usepackage{tikz}
\usetikzlibrary{cd}


\usepackage[sorting=none]{biblatex}
\addbibresource{reference.bib}


\usepackage{mathrsfs}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{stmaryrd }
\usepackage[T1]{fontenc}
\usepackage{euscript}



\usepackage{adjustbox}

\usepackage{color}


\usepackage{semantic}

\DeclareMathOperator{\colim}{colim}

\newcommand{\ovarr}{\overrightarrow}
\newcommand{\ovl}{\overline}
\newcommand{\omlim}{A_0+\sum\limits_{i\geq 1}\ovl A_i}

\newcommand{\0}{\boldsymbol{0}}
\newcommand{\1}{\boldsymbol{1}}
\newcommand{\N}{\boldsymbol{N}}
\newcommand{\R}{\boldsymbol{R}}
\newcommand{\C}{\mathcal{C}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\SBS}{\boldsymbol{SBS}}
\newcommand{\Meas}{\boldsymbol{Meas}}

\newcommand{\Gram}{\codefont{G}}
\newcommand{\mono}{\rightarrowtail}
\newcommand{\omop}{\omega^{op}}
\newcommand{\omopch}{\Theta}
\newcommand{\omch}{\Omega}
\newcommand{\Dist}{\codefont{Dist}}
\newcommand{\gd}{\dot {\mathbf{Fun}}}
\newcommand{\colomf}[1]{\varinjlim\circ\omch_{#1}^{(-)}}
\newcommand{\colom}[2]{\varinjlim(\omch_{#1}^{#2})}
\newcommand{\lcontext}{\Gamma}
\newcommand{\rcontext}{\Delta}
\newcommand{\lvar}{\gamma}
\newcommand{\rvar}{\delta}

\newcommand{\codefont}{\mathtt}

\newcommand{\tcontext}{\Gamma}
\newcommand{\tvar}{\gamma}
\newcommand{\diag}{\Delta}
\newcommand{\DThunk}{\codefont{Dist}}

\newcommand{\Unit}{\codefont{Unit}}
\newcommand{\Bool}{\codefont{Bool}}
\newcommand{\Real}{\codefont{Real}}
\newcommand{\Nat}{\codefont{Nat}}
\newcommand{\List}{\codefont{List}}
\newcommand{\Stream}{\codefont{Stream}}

\mathlig{<-}{\leftarrow}
\mathlig{->}{\to}
\mathlig{|->}{\mapsto}
\mathlig{=>}{\Rightarrow}
\mathlig{|-}{\vdash}
%\mathlig{[|}{\llbracket}
%\mathlig{|]}{\rrbracket}

\reservestyle{\command}{\codefont}
\command{inl,inr,wrap,roll,rec,corec,as,match,return,let,in,sample,on,do,Unit,Bool,Real,Nat,List,Stream,Dist}


% Distributions in programming language
\newcommand{\Uniform}{\codefont{uniform}}
\newcommand{\Normal}{\codefont{normal}}
\newcommand{\Dirac}{\codefont{dirac}}
\newcommand{\Bern}{\codefont{bernoulli}}


\AtBeginSection[] % Do nothing for \section*
{
\begin{frame}<beamer>
\frametitle{Table of contents}
\tableofcontents[currentsection]
\end{frame}
}

\title[Sheaves]{Internship defense M2\\ Parisian Master of Research in Computer Science\\  \'Elimination non-singleton~:\\ Avec les faisceaux, c'est pas faux}
\author[Soudant Léo]{\textbf{Soudant L\'eo}, fourth year student at ENS Paris Saclay}
\date[2025]{March to July 2025}

\usepackage{quiver}

\begin{document}

\begin{frame}
    \maketitle
    \centering
    Supervisor
    
    \textbf{Pierre-Marie Pédrot}

\end{frame}



\section{Topoi}

\begin{frame}
    \frametitle{The starting point}
    \begin{tabular}{ p{0.25\textwidth}cp{0.25\textwidth}cp{0.25\textwidth}}
        \centering Cartesian closed categories&
        $\Leftrightarrow$&
        \centering Simply typed $\lambda$-calculus&$\Leftrightarrow$&
        \centering Negative fragment of intuitionistic propositional logic\tabularnewline
        $\begin{array}{c}
            \mathbf{Hom}(A\times B, C)\\
            \simeq\\
            \mathbf{Hom}(A,B\to C)
        \end{array}$&&$\lambda x : A.t : A\to B$&&\inference{\Gamma,A\vdash B}{\Gamma\vdash A\to B}
    \end{tabular}
\end{frame}



\begin{frame}
    \frametitle{Subobject classifier}

    $$\mathbf{Sub}(A) \simeq \mathbf{Hom}(A,\Omega)$$
    $\mathbf{Sub(A)} := $ equivalences classes of monomorphisms $X \mono A$.

    Introduces a type of proposition in the $\lambda$-calculus, as well as subobjects
    \vspace{1cm}

    $\bullet$ All finite limits as well.
    Finite colimits are recovered\cite{maclane2012sheaves}.
\end{frame}

\begin{frame}[fragile]
    \frametitle{Formulas}
    \centering $\land,\lor,\forall,\exists,\lnot,\bot,\top,\Rightarrow$ can all be expressed \emph{e.g.}

\[\begin{tikzcd}
	{X\land Y} & Y \\
	X & A
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow[from=2-1, to=2-2]
\end{tikzcd}\]

    So can $=$ and $\in$. Equality is the predicate $A\times A \to \Omega$ given by the diagonal $A \mono A\times A$.
    \vspace{1cm}

    Objects similar to the set theoritic $\{ x\in A | \phi(x)\}$ can be constructed.
\end{frame}

\begin{frame}
    \frametitle{Internal logic of $\Omega$}

    \begin{itemize}
        \item $\land : \mathbf{Sub}(A)\times \mathbf{Sub}(A) \to \mathbf{Sub}(A)$
        \item $\land : \mathbf{Hom}(A,\Omega)\times \mathbf{Hom}(A,\Omega)\to \mathbf{Hom}(A,\Omega)$
        \item $\land : \mathbf{Hom}(A,\Omega\times \Omega)\to\mathbf{Hom}(A,\Omega)$
        \item $\land : \Omega\times\Omega \to\Omega$
    \end{itemize}

    Similarily for $\lor,\bot,\top,\Rightarrow$.
\end{frame}

\begin{frame}
    \frametitle{Topoi of presheaves}
    For a small category $\textbf{C}$, its category of presheaves is noted $\widehat{\textbf{C}} := \mathbf{Set}^{\textbf{C}^{op}}$.
    $$ (P\times Q) (C) = P(C)\times Q(C)$$
    $$P^Q(C) \simeq \mathbf{Nat}(\mathbf{y}C,P^Q)\simeq \mathbf{Nat}(\mathbf{y}C \times Q, P)$$
    \vspace{0cm}

    \centering $\Omega(C)$ is the set of subpresheaves of $\mathbf{y}C$ (also called sieves on $C$).

    \centering (A subpresheaf is pointwise a subset, with function restricted)

    \vspace{0.5cm}
    Small limits are pointwise.
\end{frame}

\begin{frame}
    \frametitle{Sheaves}

    A sheaf = A presheaf with a compatibility property.
    \vspace{0.5cm}

    A Grothendieck topology introduces a notion of cover.

\begin{itemize}
    \item If $f : D\to C$ is in $S(D)$ , then it is covered by $S$.
    \item If $f$ is covered then $f \circ g$ is covered.
    \item If $S$ covers $f$ and $R$ covers any map of $S(D)$ for all $D$, then $R$ covers $f$
\end{itemize}

We note the sieve of all maps covered by $S$ as $\ovl{S}$.

    \vspace{0.5cm}

    A sheaf is a presheaf where the inclusion of $\mathbf{Nat}(\ovl{S},F)$ in $\mathbf{Nat}(S, F)$ is an equivalence.
\end{frame}

\begin{frame}
    \frametitle{Example~: Sheaves on $\mathbf{R}^2$}

    $\textbf{C} := \mathcal{O}(\mathbf{R}^2)$ (poset~: at most one map between object).

    We fix $C := \mathbf{R}^2$.

    $S$ covers $U$ $:=$ $(U \subseteq \bigcup S)$~:
    \begin{itemize}
        \item if $U \in S$ then $U \subseteq \bigcup S$
        \item if $U \subseteq \bigcup S$, and $V \subset U$, then $V \subseteq \bigcup S$
        \item if $U \subseteq \bigcup S$, and for all $V\in S$, $V \subseteq \bigcup R$, then $U = \bigcup R$
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{The topos of sheaves}

    Finite limits of sheaves as presheaves are sheaves and are finite limits for sheaves.\vspace{1cm}

    $F^P$ is a sheaf whenever $F$ is.\vspace{1cm}
    
    $\Omega$ contains the sieves which are also sheaves, that is which only cover themselves.
\end{frame}

\begin{frame}
    \frametitle{Lawvere-Tierney topology}
    Sheaves are defined through an operator $j : \Omega \to \Omega$ for which
    \begin{itemize}
        \item $ id \leq j$, since $S\subseteq \ovl S$
%        \item $ jj \leq j$, since $\ovl S \subseteq \ovl R$ whenever $S \subseteq \ovl{R}$
%        \item $j\circ \land = \land \circ j\times j :\Omega \times \Omega \to \Omega$.
        \item $ \Rightarrow \circ id \times j \leq \Rightarrow \circ j \times j : \Omega \times \Omega ->\Omega$, since $\ovl S \subseteq \ovl R$ whenever $S \subseteq \ovl{R}$
    \end{itemize}

    This can be defined in any topos.
    \vspace{0.5cm}

    Or, rather, any type theory with a type of (strict) propositions.
\end{frame}

\section{Sheaves in Type theory}

\begin{frame}
    \frametitle{$J$-Sheaves}
    Given $J : \mathbf{Prop}->\mathbf{Prop}$ with
    \begin{itemize}
        \item $\mathbf{ret}_J : \Pi P, P -> JP$
        \item $\mathbf{bind}_J : \Pi Q P, J P -> (P -> JQ)-> JQ$
    \end{itemize}
    \vspace{0.5cm}

    A sheaf is then a type $F$ together with
    \begin{itemize}
        \item A map $\mathbf{ask} : \Pi P, JP -> (P -> F) -> F$
        \item Such that for all proposition $P$ and any proof $j$ of $JP$, $\mathbf{ask}\ P\ j\ (\lambda \_, f) = f$
    \end{itemize}
\end{frame}
\begin{frame}
    \frametitle{$IO$-sheaves}
    Noting $I := \Sigma P. J P : \mathbf{Type}$ and $O (P,j) := P : I -> \mathbf{Prop}$,\vspace{0.5cm}

    A sheaf is equivalently given by:

    $$ \begin{array}{rl}
        \mathbf{Shf} &:=\left\{\begin{array}{rl}
            F& : \mathbf{Type}\\
            \mathbf{ask}&: \Pi i:I, (O\ i -> F) -> F\\
            \varepsilon&:\Pi (i:I)(f:F), \mathbf{ask}\ i\ (\lambda\_, f) = f 
        \end{array}\right\}
    \end{array}$$
    A type has at most one sheaf structure (with univalence).
\end{frame}

\section{Sheaf type theories}

\begin{frame}
   \frametitle{The sheaf model}

   $$ \begin{array}{rl}
        [\mathbf{Type}] &:= \{F:=\mathbf{Shf}; \dots\}\\
        \left[\Pi a : A, B\right] &:= \{F:= \Pi a : \llbracket A\rrbracket, \llbracket B\rrbracket; \dots\}\\
        \llbracket A \rrbracket&:= F\ [A]\\
%        \left[x\right] := x

    \end{array} $$
\end{frame}

\begin{frame}
    \frametitle{Positive types}
    Interpreting positive types requires higher inductive types.
    
$$
\begin{array}{l}
    \mathbf{Inductive}\ \mathbf{B} : \mathbf{Type} := \\
    \mid \mathbf{true} : \mathbf{B}\\
    \mid \mathbf{false} : \mathbf{B}\\
    \mid \mathbf{ask}_{\mathbf{B}} : \Pi (i:I). (O\ i -> \mathbf{B}) -> \mathbf{B}\\
    \mid \varepsilon_\mathbf{B} : \Pi (i:I)\ (b : \mathbf B). \mathbf{ask}\ i\ (\lambda \_. b) = b
\end{array}
$$
$$
\begin{array}{rl}
    [B] &:={F:= B; \mathbf{ask}:=\mathbf{ask}_B;\varepsilon := \varepsilon_B}
\end{array}
$$

\end{frame}

\begin{frame}
    \frametitle{Basic sheaf theory}

    $$\begin{array}{rl}
        [\mathbf{ask}] &:= \mathbf{ask}\\
    \end{array}$$

    But $\mathbf{ask}$ has type  $\Pi (A : \mathbf{Shf}) (i:I), (O\ i -> A ) -> A$, should be $\llbracket ? \rrbracket$
    \vspace{1cm}

    An approximation~:

    $$\inference{O_i,\Gamma\vdash k : A}{\Gamma\vdash \mathbf{ask}_i\ k : A}\qquad \inference{}{O_i,\Gamma\vdash \mathbf{ask}_i\ k \equiv k}$$
    With $[\mathbf{ask}_i\ k] := \mathbf{ask}\ [A]\ i\ (\lambda (o_i: O_i), [k])$
\end{frame}

\begin{frame}
    \frametitle{Geometric formulas}

    $$\bigwedge_{i : I}\left(\forall \overrightarrow{x}, O_i => \bigvee_{j : J_i}\exists \overrightarrow{y}, Q_{i,j}\right)$$
    \vspace{0.5cm}

    Up to curryfication, of the shape $\Pi i, O i$.


    $$ \inference{Q_{i,1},\overrightarrow{y},\Gamma\vdash k_1:A & \cdots & Q_{i,n},\overrightarrow{y},\Gamma\vdash k_n : A}{O_i,\Gamma\vdash \mathbf{ask}_i\ A\ \overrightarrow{x}\ \overrightarrow{k} : A}$$
\end{frame}

\begin{frame}
    \frametitle{Normalisation of a modified system $T$}
    \begin{itemize}
        \item No types-as-terms
        \item Natural numbers, functions, empty type
    \end{itemize}
    $$\bigwedge_{i : I}\bigvee_{j : J_i} O_{i,j}$$

    Proof of normalisation through logical relations.
\end{frame}

\begin{frame}
    \frametitle{Example of working theory}
    With an extra cohen real $\alpha : \mathbf{N} -> \mathbf{B}$

    $$ \begin{array}{rl}
        &\left(\bigwedge_{n} \top -> (n \mapsto_\alpha \mathbf{true}) \vee (n \mapsto_\alpha \mathbf{false})\right)\\
        \land &\left(\bigwedge_{n } (n\mapsto_\alpha \mathbf{true}) \wedge (n \mapsto_\alpha \mathbf{false}) -> \bot \right)
    \end{array} $$
    \vspace{0cm} 

\centering $\inference{}{n\mapsto_\alpha b\vdash\alpha\ n \equiv b : \mathbf{B}}$ and $\mathbf{ask}_n\ A:= \mathbf{B}_{rec}\ A\ (\alpha\ n)$
\vspace{0.5cm}

Can be used to show continuity of functionals $(\mathbf{N} -> \mathbf{B}) -> \mathbf{N}$

\end{frame}

\section{Bibliography}

\begin{frame}[allowframebreaks]
    \frametitle{Bibliography}

    \printbibliography

\end{frame}

\end{document}